# –ü–æ–ª–Ω—ã–π —Ä–∞–∑–±–æ—Ä docker-compose.yml

> **–¶–µ–ª—å –¥–æ–∫—É–º–µ–Ω—Ç–∞:** –î–µ—Ç–∞–ª—å–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É docker-compose.yml –æ—Ç –±–∞–∑–æ–≤—ã—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏–π YAML –¥–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ñ–∏—á Docker Compose.

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–£—Ä–æ–≤–µ–Ω—å 1: –ë–∞–∑–æ–≤—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å YAML](#—É—Ä–æ–≤–µ–Ω—å-1-–±–∞–∑–æ–≤—ã–π-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å-yaml)
2. [–£—Ä–æ–≤–µ–Ω—å 2: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Docker Compose](#—É—Ä–æ–≤–µ–Ω—å-2-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-docker-compose-—Ñ–∞–π–ª–∞)
3. [–£—Ä–æ–≤–µ–Ω—å 3: –†–∞–∑–±–æ—Ä –ø–æ —Å–µ–∫—Ü–∏—è–º](#—É—Ä–æ–≤–µ–Ω—å-3-—Ä–∞–∑–±–æ—Ä-–ø–æ-—Å–µ–∫—Ü–∏—è–º)
4. [–£—Ä–æ–≤–µ–Ω—å 4: –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞](#—É—Ä–æ–≤–µ–Ω—å-4-–¥–µ—Ç–∞–ª—å–Ω—ã–π-—Ä–∞–∑–±–æ—Ä-–∫–∞–∂–¥–æ–≥–æ-—Å–µ—Ä–≤–∏—Å–∞)
   - [PostgreSQL](#—Å–µ—Ä–≤–∏—Å-1-postgresql)
   - [Backend](#—Å–µ—Ä–≤–∏—Å-2-backend-fastapi)
   - [Tests](#—Å–µ—Ä–≤–∏—Å-3-tests-pytest)
5. [–£—Ä–æ–≤–µ–Ω—å 5: Volumes –∏ Networks](#—É—Ä–æ–≤–µ–Ω—å-5-volumes-–∏-networks)
6. [–£—Ä–æ–≤–µ–Ω—å 6: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏](#—É—Ä–æ–≤–µ–Ω—å-6-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-–∫–æ–Ω—Ü–µ–ø—Ü–∏–∏)

---

## –£—Ä–æ–≤–µ–Ω—å 1: –ë–∞–∑–æ–≤—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å YAML

### –ß—Ç–æ —Ç–∞–∫–æ–µ YAML?

**YAML** (YAML Ain't Markup Language) - —ç—Ç–æ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –ª–µ–≥–∫–æ —á–∏—Ç–∞–µ—Ç—Å—è —á–µ–ª–æ–≤–µ–∫–æ–º.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ YAML:

```yaml
# 1. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å —Å–∏–º–≤–æ–ª–∞ #
# 2. –û—Ç—Å—Ç—É–ø—ã = –¢–û–õ–¨–ö–û –ü–†–û–ë–ï–õ–´ (–ù–ï –¢–ê–ë–´!)
# 3. –ö–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ = 2 –ø—Ä–æ–±–µ–ª–∞

# –ö–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ (—Å—Ç—Ä–æ–∫–∞)
key: value

# –ß–∏—Å–ª–æ
port: 8000

# –ë—É–ª–µ–≤–æ –∑–Ω–∞—á–µ–Ω–∏–µ
enabled: true
debug: false

# –°–ø–∏—Å–æ–∫ (–º–∞—Å—Å–∏–≤) - —Å–ø–æ—Å–æ–± 1
ports:
  - "8000:8000"
  - "5432:5432"

# –°–ø–∏—Å–æ–∫ - —Å–ø–æ—Å–æ–± 2 (inline)
ports: ["8000:8000", "5432:5432"]

# –û–±—ä–µ–∫—Ç (—Å–ª–æ–≤–∞—Ä—å)
environment:
  DB_HOST: localhost
  DB_PORT: 5432

# –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç
description: |
  –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞
  –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞
```

### ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏:

```yaml
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–∞–±—ã
services:
	postgres:  # –¢–∞–± –≤–º–µ—Å—Ç–æ –ø—Ä–æ–±–µ–ª–æ–≤

# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –Ω–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã
services:
  postgres:
     image: postgres  # 5 –ø—Ä–æ–±–µ–ª–æ–≤
   ports:  # 3 –ø—Ä–æ–±–µ–ª–∞

# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - 2 –ø—Ä–æ–±–µ–ª–∞ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å
services:
  postgres:
    image: postgres
    ports:
      - "5432:5432"
```

---

## –£—Ä–æ–≤–µ–Ω—å 2: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Docker Compose —Ñ–∞–π–ª–∞

### –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

–§–∞–π–ª `docker-compose.yml` —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 4 –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–µ–∫—Ü–∏–π:

```yaml
version: '3.8'           # 1. –í–µ—Ä—Å–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ (—É—Å—Ç–∞—Ä–µ–≤—à–∞—è, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

services:                # 2. –û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  postgres: {...}
  backend: {...}
  tests: {...}

volumes:                 # 3. –•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  postgres_data:

networks:                # 4. –°–µ—Ç–∏ –¥–ª—è —Å–≤—è–∑–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  app_network:
```

### –õ–æ–≥–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏ `docker-compose up`:

```
1. –ß—Ç–µ–Ω–∏–µ docker-compose.yml
   ‚Üì
2. –°–æ–∑–¥–∞–Ω–∏–µ networks (app_network)
   ‚Üì
3. –°–æ–∑–¥–∞–Ω–∏–µ volumes (postgres_data)
   ‚Üì
4. –ó–∞–ø—É—Å–∫ services –≤ –ø–æ—Ä—è–¥–∫–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
   ‚îú‚îÄ postgres (–ø–µ—Ä–≤—ã–º)
   ‚îú‚îÄ backend (–ø–æ—Å–ª–µ postgres healthy)
   ‚îî‚îÄ tests (–ø–æ—Å–ª–µ backend started)
```

---

## –£—Ä–æ–≤–µ–Ω—å 3: –†–∞–∑–±–æ—Ä –ø–æ —Å–µ–∫—Ü–∏—è–º

### –°–µ–∫—Ü–∏—è 1: VERSION

```yaml
version: '3.8'
```

**–ß—Ç–æ —ç—Ç–æ:**
- –£–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä—Å–∏—é —Ñ–æ—Ä–º–∞—Ç–∞ Docker Compose
- `3.8` - –æ–¥–Ω–∞ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏–π —Ñ–æ—Ä–º–∞—Ç–∞ Compose v3

**‚ö†Ô∏è –í–ê–ñ–ù–û:**
- –í Docker Compose v2 (—Ç–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è) —ç—Ç–æ –ø–æ–ª–µ **—É—Å—Ç–∞—Ä–µ–≤—à–µ–µ**
- –ú–æ–∂–Ω–æ —Å–º–µ–ª–æ —É–¥–∞–ª–∏—Ç—å - —Ä–∞–±–æ—Ç–∞—Ç—å –±—É–¥–µ—Ç —Ç–∞–∫ –∂–µ
- Docker –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç warning: `"the attribute version is obsolete"`

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:**
```yaml
# –ü—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É version
# Docker Compose v2 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç —Ñ–æ—Ä–º–∞—Ç
```

---

### –°–µ–∫—Ü–∏—è 2: SERVICES

```yaml
services:
  postgres:    # –ò–º—è —Å–µ—Ä–≤–∏—Å–∞ #1
  backend:     # –ò–º—è —Å–µ—Ä–≤–∏—Å–∞ #2
  tests:       # –ò–º—è —Å–µ—Ä–≤–∏—Å–∞ #3
```

**–ß—Ç–æ —ç—Ç–æ:**
- `services` - –∫–æ—Ä–Ω–µ–≤–æ–π –∫–ª—é—á, –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å = –æ–¥–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏ scaling)

**–ò–º—è —Å–µ—Ä–≤–∏—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:**
- DNS-—Ä–µ–∑–æ–ª–≤–∏–Ω–≥–∞ –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏ (–º–æ–∂–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è `http://backend:8000`)
- –°—Å—ã–ª–æ–∫ –≤ `depends_on`
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ CLI: `docker-compose up postgres`

---

## –£—Ä–æ–≤–µ–Ω—å 4: –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

## –°–µ—Ä–≤–∏—Å 1: PostgreSQL

```yaml
postgres:
  image: postgres:15-alpine
  container_name: users_db
  environment:
    POSTGRES_USER: testuser
    POSTGRES_PASSWORD: testpass
    POSTGRES_DB: testdb
  ports:
    - "5432:5432"
  volumes:
    - postgres_data:/var/lib/postgresql/data
  healthcheck:
    test: ["CMD-SHELL", "pg_isready -U testuser -d testdb"]
    interval: 10s
    timeout: 5s
    retries: 5
  networks:
    - app_network
```

---

### üì¶ IMAGE

```yaml
image: postgres:15-alpine
```

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `image` - –∏—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ –∏–∑ Docker Hub (–ù–ï —Å–æ–±–∏—Ä–∞–µ–º —Å–≤–æ–π)
- `postgres` - –∏–º—è –æ–±—Ä–∞–∑–∞
- `15` - –º–∞–∂–æ—Ä–Ω–∞—è –≤–µ—Ä—Å–∏—è PostgreSQL
- `alpine` - –æ–±–ª–µ–≥—á–µ–Ω–Ω—ã–π Linux –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤ Alpine Linux

**–†–∞–∑–º–µ—Ä—ã –æ–±—Ä–∞–∑–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:**
```
postgres:15-alpine  ‚âà 240 MB  ‚Üê –ò—Å–ø–æ–ª—å–∑—É–µ–º (–ª–µ–≥–∫–∏–π)
postgres:15         ‚âà 380 MB  (–Ω–∞ Debian)
postgres:latest     ‚âà 380 MB  (–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è, –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**

```yaml
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –º–∏–Ω–æ—Ä–Ω–∞—è –≤–µ—Ä—Å–∏—è (–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ)
image: postgres:15.4-alpine

# –í–∞—Ä–∏–∞–Ω—Ç 2: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ–±—Ä–∞–∑ (–Ω–µ alpine)
image: postgres:15

# –í–∞—Ä–∏–∞–Ω—Ç 3: Latest (–ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞!)
image: postgres:latest
```

**üí° –ü–æ—á–µ–º—É alpine?**
- ‚úÖ –ú–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è
- ‚úÖ –ú–µ–Ω—å—à–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π (–º–µ–Ω—å—à–µ –ø–∞–∫–µ—Ç–æ–≤)
- ‚ùå –ú–æ–∂–µ—Ç –Ω–µ —Ö–≤–∞—Ç–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —É—Ç–∏–ª–∏—Ç (–Ω–æ –¥–ª—è PostgreSQL –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)

---

### üè∑Ô∏è CONTAINER_NAME

```yaml
container_name: users_db
```

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –Ø–≤–Ω–æ –∑–∞–¥–∞–µ—Ç –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ Docker
- –ë–µ–∑ —ç—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ Docker —Å–æ–∑–¥–∞—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–º—è: `dockerkube_postgres_1`
- **–í–ê–ñ–ù–û:** –ò–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –≤ —Å–∏—Å—Ç–µ–º–µ

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ:**

| –° `container_name` | –ë–µ–∑ `container_name` |
|-------------------|---------------------|
| `users_db` | `dockerkube_postgres_1` |
| –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–º—è | –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| –£–¥–æ–±–Ω–æ –¥–ª—è –ª—é–¥–µ–π | –£–¥–æ–±–Ω–æ –¥–ª—è scaling |
| `docker logs users_db` | `docker logs dockerkube_postgres_1` |

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –î–ª—è dev-–æ–∫—Ä—É–∂–µ–Ω–∏—è (—É–¥–æ–±–Ω–æ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å)
- ‚úÖ –ö–æ–≥–¥–∞ scaling –Ω–µ –Ω—É–∂–µ–Ω
- ‚ùå –î–ª—è production —Å scaling (–±—É–¥–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç –∏–º–µ–Ω –ø—Ä–∏ `docker-compose up --scale postgres=3`)

---

### üåç ENVIRONMENT

```yaml
environment:
  POSTGRES_USER: testuser        # –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î
  POSTGRES_PASSWORD: testpass    # –ü–∞—Ä–æ–ª—å
  POSTGRES_DB: testdb            # –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `environment` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ `postgres` **—á–∏—Ç–∞–µ—Ç —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:**

1. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å—Ç–∞—Ä—Ç—É–µ—Ç
2. –°–∫—Ä–∏–ø—Ç `/docker-entrypoint.sh` —á–∏—Ç–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –í—ã–ø–æ–ª–Ω—è–µ—Ç SQL –∫–æ–º–∞–Ω–¥—ã:
   ```sql
   CREATE USER testuser WITH PASSWORD 'testpass';
   CREATE DATABASE testdb OWNER testuser;
   GRANT ALL PRIVILEGES ON DATABASE testdb TO testuser;
   ```
4. PostgreSQL –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –ø–µ—Ä–µ–¥–∞—á–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:**

**–°–ø–æ—Å–æ–± 1: Inline —Å–ª–æ–≤–∞—Ä—å (—Ç–µ–∫—É—â–∏–π)**
```yaml
environment:
  POSTGRES_USER: testuser
  POSTGRES_PASSWORD: testpass
```

**–°–ø–æ—Å–æ–± 2: –ú–∞—Å—Å–∏–≤**
```yaml
environment:
  - POSTGRES_USER=testuser
  - POSTGRES_PASSWORD=testpass
```

**–°–ø–æ—Å–æ–± 3: –ò–∑ —Ñ–∞–π–ª–∞ .env**
```yaml
env_file:
  - .env
```
–§–∞–π–ª `.env`:
```
POSTGRES_USER=testuser
POSTGRES_PASSWORD=testpass
POSTGRES_DB=testdb
```

**–°–ø–æ—Å–æ–± 4: –ò–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è —Ö–æ—Å—Ç–∞**
```yaml
environment:
  POSTGRES_USER: ${DB_USER}      # –ë–µ—Ä–µ—Ç –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è —Ö–æ—Å—Ç–∞
  POSTGRES_PASSWORD: ${DB_PASS}
```

**üîí Best Practice –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤ (production):**
```yaml
# –ù–ï —Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ docker-compose.yml –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ!
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker Secrets
environment:
  POSTGRES_PASSWORD_FILE: /run/secrets/db_password
secrets:
  - db_password
```

---

### üîå PORTS

```yaml
ports:
  - "5432:5432"
```

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

–§–æ—Ä–º–∞—Ç: `"HOST_PORT:CONTAINER_PORT"`

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –í–∞—à –ü–ö     ‚îÇ         ‚îÇ   –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä      ‚îÇ
‚îÇ  (—Ö–æ—Å—Ç)     ‚îÇ         ‚îÇ                  ‚îÇ
‚îÇ             ‚îÇ         ‚îÇ                  ‚îÇ
‚îÇ  :5432  ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ  :5432           ‚îÇ
‚îÇ  (—Å–ª–µ–≤–∞)    ‚îÇ         ‚îÇ  (—Å–ø—Ä–∞–≤–∞)        ‚îÇ
‚îÇ             ‚îÇ         ‚îÇ  PostgreSQL      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç `"5432:5432"`:**
- `5432` (—Å–ª–µ–≤–∞) - –ø–æ—Ä—Ç –Ω–∞ **–≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ**
- `5432` (—Å–ø—Ä–∞–≤–∞) - –ø–æ—Ä—Ç **–≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**
- –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ `localhost:5432` ‚Üí –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ –ø–æ—Ä—Ç `5432`

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:**

**–í–∞—Ä–∏–∞–Ω—Ç 1: –†–∞–∑–Ω—ã–µ –ø–æ—Ä—Ç—ã**
```yaml
ports:
  - "5433:5432"  # –°–Ω–∞—Ä—É–∂–∏ :5433, –≤–Ω—É—Ç—Ä–∏ :5432
```
–ü–æ–ª–µ–∑–Ω–æ, –µ—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å PostgreSQL –Ω–∞ –ø–æ—Ä—Ç—É 5432

**–í–∞—Ä–∏–∞–Ω—Ç 2: Bind –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É IP**
```yaml
ports:
  - "127.0.0.1:5432:5432"  # –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ —Å localhost
```
–ë–µ–∑–æ–ø–∞—Å–Ω–µ–µ - –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–æ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏

**–í–∞—Ä–∏–∞–Ω—Ç 3: Expose –±–µ–∑ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞—Ä—É–∂—É**
```yaml
expose:
  - "5432"  # –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –¥—Ä—É–≥–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
# –ù–ï–¢ ports!
```
–°–∞–º—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø —Å —Ö–æ—Å—Ç–∞

**–¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç:**
- ‚úÖ –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —Å —Ö–æ—Å—Ç–∞: `psql -h localhost -p 5432 -U testuser -d testdb`
- ‚úÖ –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∏–∑ –¥—Ä—É–≥–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: `postgresql://testuser:testpass@postgres:5432/testdb`
- ‚ö†Ô∏è –î–æ—Å—Ç—É–ø–Ω–æ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ (–µ—Å–ª–∏ —Ñ–∞–µ—Ä–≤–æ–ª —Ä–∞–∑—Ä–µ—à–∞–µ—Ç)

---

### üíæ VOLUMES

```yaml
volumes:
  - postgres_data:/var/lib/postgresql/data
```

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

–§–æ—Ä–º–∞—Ç: `VOLUME_NAME:CONTAINER_PATH`

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Docker Host        ‚îÇ         ‚îÇ   –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä              ‚îÇ
‚îÇ                     ‚îÇ         ‚îÇ                          ‚îÇ
‚îÇ  /var/lib/docker/   ‚îÇ         ‚îÇ  /var/lib/postgresql/    ‚îÇ
‚îÇ    volumes/         ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    data/                 ‚îÇ
‚îÇ    postgres_data/   ‚îÇ  Mount  ‚îÇ                          ‚îÇ
‚îÇ                     ‚îÇ         ‚îÇ  (—Ñ–∞–π–ª—ã –ë–î –∑–¥–µ—Å—å)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ó–∞—á–µ–º –Ω—É–∂–Ω—ã volumes:**

**–ë–µ–∑ volume:**
```
–î–∞–Ω–Ω—ã–µ –ë–î ‚Üí —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose down ‚Üí ‚ùå –í–°–ï –î–ê–ù–ù–´–ï –ü–û–¢–ï–†–Ø–ù–´!
```

**–° volume:**
```
–î–∞–Ω–Ω—ã–µ –ë–î ‚Üí —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º volume
docker-compose down ‚Üí ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
docker-compose up ‚Üí ‚úÖ –î–∞–Ω–Ω—ã–µ –Ω–∞ –º–µ—Å—Ç–µ!
```

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä:**

```bash
# 1. –°–æ–∑–¥–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –ë–î
docker-compose up
# –î–æ–±–∞–≤–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ API

# 2. –£–¥–∞–ª–∏–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose down

# 3. –ó–∞–ø—É—Å—Ç–∏–ª–∏ —Å–Ω–æ–≤–∞
docker-compose up

# ‚úÖ –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–∞ –º–µ—Å—Ç–µ! (–±–ª–∞–≥–æ–¥–∞—Ä—è volume)
```

**–¢–∏–ø—ã volume:**

**–¢–∏–ø 1: Named Volume (—Ç–µ–∫—É—â–∏–π - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
```yaml
volumes:
  - postgres_data:/var/lib/postgresql/data
```
- ‚úÖ Docker —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ–º
- ‚úÖ –ü–µ—Ä–µ–Ω–æ—Å–∏–º–æ –º–µ–∂–¥—É –û–°
- ‚úÖ –õ–µ–≥–∫–æ –±—ç–∫–∞–ø–∏—Ç—å: `docker run --rm -v postgres_data:/data -v $(pwd):/backup alpine tar czf /backup/backup.tar.gz /data`

**–¢–∏–ø 2: Bind Mount (–ø–∞–ø–∫–∞ –Ω–∞ —Ö–æ—Å—Ç–µ)**
```yaml
volumes:
  - ./db_data:/var/lib/postgresql/data
```
- ‚úÖ –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º —Å —Ö–æ—Å—Ç–∞
- ‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ (–æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ Linux)
- ‚ùå –ü—É—Ç–∏ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –Ω–∞ Windows/Linux

**–¢–∏–ø 3: Anonymous Volume**
```yaml
volumes:
  - /var/lib/postgresql/data  # –ë–µ–∑ –∏–º–µ–Ω–∏
```
- ‚ùå –°–ª–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å (—Å–ª—É—á–∞–π–Ω–æ–µ –∏–º—è)
- ‚ùå –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è

**–ì–¥–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ:**

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ volumes
docker volume ls

# –£–∑–Ω–∞—Ç—å –ø—É—Ç—å –∫ volume
docker volume inspect dockerkube_postgres_data
# Output: "Mountpoint": "/var/lib/docker/volumes/dockerkube_postgres_data/_data"

# –í Windows (Docker Desktop —Å WSL2):
# \\wsl$\docker-desktop-data\data\docker\volumes\dockerkube_postgres_data\_data
```

**–£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ò —É–¥–∞–ª–∏—Ç—å volumes
docker-compose down -v

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π volume
docker volume rm dockerkube_postgres_data
```

---

### üè• HEALTHCHECK

```yaml
healthcheck:
  test: ["CMD-SHELL", "pg_isready -U testuser -d testdb"]
  interval: 10s
  timeout: 5s
  retries: 5
```

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

**–ß—Ç–æ —Ç–∞–∫–æ–µ healthcheck:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä **–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç**
- Docker –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–¥ 0 ‚Üí —Å—Ç–∞—Ç—É—Å `healthy`
- –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ 0 ‚Üí —Å—Ç–∞—Ç—É—Å `unhealthy`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

#### 1. `test` - –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
```yaml
test: ["CMD-SHELL", "pg_isready -U testuser -d testdb"]
```
- `CMD-SHELL` - –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ shell (`/bin/sh -c`)
- `pg_isready` - —É—Ç–∏–ª–∏—Ç–∞ PostgreSQL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
  - `-U testuser` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `-d testdb` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ï—Å–ª–∏ –ë–î –≥–æ—Ç–æ–≤–∞ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è ‚Üí –∫–æ–¥ 0 ‚Üí `healthy`

#### 2. `interval` - –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏
```yaml
interval: 10s
```
- –ö–∞–∂–¥—ã–µ **10 —Å–µ–∫—É–Ω–¥** –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É
- –§–æ—Ä–º–∞—Ç—ã: `5s`, `1m30s`, `2m`

#### 3. `timeout` - —Ç–∞–π–º–∞—É—Ç –∫–æ–º–∞–Ω–¥—ã
```yaml
timeout: 5s
```
- –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª–∞ –∑–∞ **5 —Å–µ–∫—É–Ω–¥** ‚Üí —Å—á–∏—Ç–∞—Ç—å –Ω–µ—É–¥–∞—á–µ–π
- –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≤–∏—Å—à–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫

#### 4. `retries` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
```yaml
retries: 5
```
- –ü–æ—Å–ª–µ **5 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø–æ–¥—Ä—è–¥** ‚Üí —Å—Ç–∞—Ç—É—Å `unhealthy`
- –î–æ —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ —Å—Ç–∞—Ç—É—Å `starting`

**–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª healthcheck:**

```
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω
     ‚Üì
[starting] ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚Üì           ‚îÇ
–ü—Ä–æ–≤–µ—Ä–∫–∞ 1       ‚îÇ
 (failed)        ‚îÇ retries = 5
     ‚Üì           ‚îÇ
–ü—Ä–æ–≤–µ—Ä–∫–∞ 2       ‚îÇ
 (failed)        ‚îÇ
     ‚Üì           ‚îÇ
...              ‚îÇ
     ‚Üì           ‚îÇ
–ü—Ä–æ–≤–µ—Ä–∫–∞ 5       ‚îÇ
 (failed)        ‚îÇ
     ‚Üì‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
[unhealthy] ‚ùå

–ò–õ–ò

–ü—Ä–æ–≤–µ—Ä–∫–∞ 1
 (success)
     ‚Üì
[healthy] ‚úÖ
     ‚Üì
–ö–∞–∂–¥—ã–µ 10s –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:**

**HTTP endpoint (–¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤):**
```yaml
healthcheck:
  test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
  interval: 30s
  timeout: 10s
  retries: 3
```

**TCP socket:**
```yaml
healthcheck:
  test: ["CMD-SHELL", "nc -z localhost 5432 || exit 1"]
```

**–û—Ç–∫–ª—é—á–∏—Ç—å healthcheck:**
```yaml
healthcheck:
  disable: true
```

**üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**

Healthcheck –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è `depends_on`:

```yaml
backend:
  depends_on:
    postgres:
      condition: service_healthy  # ‚Üê –í–æ—Ç –∑–∞—á–µ–º –Ω—É–∂–µ–Ω healthcheck!
```

**–ë–µ–∑ healthcheck:**
```yaml
depends_on:
  - postgres  # –ñ–¥–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```
- ‚ùå Backend –º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è —Ä–∞–Ω—å—à–µ, —á–µ–º PostgreSQL –≥–æ—Ç–æ–≤
- ‚ùå –û—à–∏–±–∫–∏ "connection refused"

**–° healthcheck:**
```yaml
depends_on:
  postgres:
    condition: service_healthy
```
- ‚úÖ Backend –∂–¥–µ—Ç, –ø–æ–∫–∞ –ë–î **–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≥–æ—Ç–æ–≤–∞**
- ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

---

### üåê NETWORKS

```yaml
networks:
  - app_network
```

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

**–ß—Ç–æ —Ç–∞–∫–æ–µ Docker networks:**
- –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏ **–≤–∏–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –ø–æ –∏–º–µ–Ω–∞–º —Å–µ—Ä–≤–∏—Å–æ–≤**
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ç—è—Ö **–Ω–µ –º–æ–≥—É—Ç –æ–±—â–∞—Ç—å—Å—è**

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ app_network ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                                            ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ postgres ‚îÇ    ‚îÇ backend ‚îÇ    ‚îÇ tests‚îÇ ‚îÇ
‚îÇ  ‚îÇ          ‚îÇ    ‚îÇ         ‚îÇ    ‚îÇ      ‚îÇ ‚îÇ
‚îÇ  ‚îÇ :5432    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚î§ API     ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚î§ pytest‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ  DNS —Ä–µ–∑–æ–ª–≤–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç:                   ‚îÇ
‚îÇ  postgres ‚Üí 172.18.0.2                    ‚îÇ
‚îÇ  backend  ‚Üí 172.18.0.3                    ‚îÇ
‚îÇ  tests    ‚Üí 172.18.0.4                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è DNS (–∏–∑ backend):**
```yaml
environment:
  DATABASE_URL: postgresql://testuser:testpass@postgres:5432/testdb
#                                              ^^^^^^^^
#                                              –ò–º—è —Å–µ—Ä–≤–∏—Å–∞ = DNS –∏–º—è!
```

**–¢–∏–ø—ã networks:**

**Bridge (—Ç–µ–∫—É—â–∏–π - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):**
```yaml
networks:
  app_network:
    driver: bridge
```
- ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞
- ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è –æ—Ç –¥—Ä—É–≥–∏—Ö —Å–µ—Ç–µ–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π DNS

**Host (–±–µ–∑ –∏–∑–æ–ª—è—Ü–∏–∏):**
```yaml
network_mode: host
```
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ç—å —Ö–æ—Å—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é
- ‚ùå –ù–µ—Ç –∏–∑–æ–ª—è—Ü–∏–∏
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**Overlay (–¥–ª—è Docker Swarm):**
```yaml
networks:
  app_network:
    driver: overlay
```
- –î–ª—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (multi-host)
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏

**–ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å networks:**
```yaml
services:
  postgres:
    # ... (–Ω–µ—Ç networks)
```
Docker —Å–æ–∑–¥–∞—Å—Ç **default network** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: `dockerkube_default`
- ‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤—Å–µ —Ä–∞–≤–Ω–æ —É–≤–∏–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞
- ‚ùå –ú–µ–Ω—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—è

---

## –°–µ—Ä–≤–∏—Å 2: Backend (FastAPI)

```yaml
backend:
  build:
    context: .
    dockerfile: docker/backend.Dockerfile
  container_name: users_api
  environment:
    DATABASE_URL: postgresql://testuser:testpass@postgres:5432/testdb
  ports:
    - "8000:8000"
  depends_on:
    postgres:
      condition: service_healthy
  networks:
    - app_network
  restart: unless-stopped
```

---

### üî® BUILD

```yaml
build:
  context: .
  dockerfile: docker/backend.Dockerfile
```

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

**–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `image` –∏ `build`:**

| `image` | `build` |
|---------|---------|
| –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ | –°–æ–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑ –∏–∑ Dockerfile |
| `image: postgres:15` | `build: ./backend` |
| –ë—ã—Å—Ç—Ä–µ–µ (—Å–∫–∞—á–∞—Ç—å —Å Docker Hub) | –ú–µ–¥–ª–µ–Ω–Ω–µ–µ (—Å–æ–±—Ä–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ) |
| –î–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ | –î–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∫–æ–¥–∞ |

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã build:**

#### `context` - –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–±–æ—Ä–∫–∏
```yaml
context: .
```
- `.` = —Ç–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- –í—Å–µ —Ñ–∞–π–ª—ã –∏–∑ —ç—Ç–æ–π –ø–∞–ø–∫–∏ **–¥–æ—Å—Ç—É–ø–Ω—ã –ø—Ä–∏ —Å–±–æ—Ä–∫–µ**
- –ö–æ–º–∞–Ω–¥—ã `COPY` –∏ `ADD` –≤ Dockerfile —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ context

#### `dockerfile` - –ø—É—Ç—å –∫ Dockerfile
```yaml
dockerfile: docker/backend.Dockerfile
```
- –ü—É—Ç—å **–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ context**
- –ü–æ–ª–Ω—ã–π –ø—É—Ç—å: `./docker/backend.Dockerfile`

**–ü—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∫–∏:**

```bash
docker-compose up --build
     ‚Üì
–ß–∏—Ç–∞–µ—Ç docker-compose.yml
     ‚Üì
–ù–∞—Ö–æ–¥–∏—Ç —Å–µ–∫—Ü–∏—é build –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ backend
     ‚Üì
–í—ã–ø–æ–ª–Ω—è–µ—Ç:
  cd .  (–ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ context)
  docker build -f docker/backend.Dockerfile -t dockerkube-backend .
     ‚Üì
–ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–∑ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:**

**–ö–æ—Ä–æ—Ç–∫–∞—è —Ñ–æ—Ä–º–∞:**
```yaml
build: ./backend  # –ò—â–µ—Ç Dockerfile –≤ –ø–∞–ø–∫–µ backend
```

**–° –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ —Å–±–æ—Ä–∫–∏:**
```yaml
build:
  context: .
  dockerfile: docker/backend.Dockerfile
  args:
    PYTHON_VERSION: 3.11
    APP_ENV: development
```
–í Dockerfile:
```dockerfile
ARG PYTHON_VERSION=3.10
FROM python:${PYTHON_VERSION}-slim
```

**–° target (multi-stage build):**
```yaml
build:
  context: .
  dockerfile: docker/backend.Dockerfile
  target: production  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å stage "production"
```

**–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–µ–≤:**

Docker –∫—ç—à–∏—Ä—É–µ—Ç —Å–ª–æ–∏ –æ–±—Ä–∞–∑–∞:
- ‚úÖ –ï—Å–ª–∏ `requirements.txt` –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à (–±—ã—Å—Ç—Ä–æ)
- ‚ùå –ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è ‚Üí –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–º–µ–¥–ª–µ–Ω–Ω–æ)

```bash
# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ë–ï–ó –∫—ç—à–∞
docker-compose build --no-cache backend

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å
docker-compose build backend
```

---

### üîó DEPENDS_ON

```yaml
depends_on:
  postgres:
    condition: service_healthy
```

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

`depends_on` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç:
1. **–ü–æ—Ä—è–¥–æ–∫ –∑–∞–ø—É—Å–∫–∞** –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
2. **–£—Å–ª–æ–≤–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏** –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–£—Å–ª–æ–≤–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

#### `service_started` - –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—â–µ–Ω
```yaml
depends_on:
  postgres:
    condition: service_started
```
- ‚úÖ –ñ–¥–µ—Ç, –ø–æ–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä **–∑–∞–ø—É—Å—Ç–∏–ª—Å—è**
- ‚ùå –ù–ï –∂–¥–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞
- PostgreSQL –º–æ–∂–µ—Ç –µ—â–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è

#### `service_healthy` - –ø—Ä–æ—à–µ–ª healthcheck
```yaml
depends_on:
  postgres:
    condition: service_healthy  # ‚Üê –ò—Å–ø–æ–ª—å–∑—É–µ–º
```
- ‚úÖ –ñ–¥–µ—Ç —Å—Ç–∞—Ç—É—Å `healthy`
- ‚úÖ PostgreSQL –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –≥–æ—Ç–æ–≤
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç `healthcheck` —É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

#### `service_completed_successfully`
```yaml
depends_on:
  migration:
    condition: service_completed_successfully
```
- –ñ–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å –∫–æ–¥–æ–º 0
- –î–ª—è init-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (–º–∏–≥—Ä–∞—Ü–∏–∏, seed)

**–ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø—Ä–æ–µ–∫—Ç–∞:**

```
postgres (—Å healthcheck)
   ‚Üì service_healthy
backend
   ‚Üì service_started
tests
```

**–ü–æ—Ä—è–¥–æ–∫ –∑–∞–ø—É—Å–∫–∞:**
1. `postgres` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º
2. –ñ–¥–µ–º `healthy` —Å—Ç–∞—Ç—É—Å (‚âà10-30 —Å–µ–∫)
3. `backend` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
4. `tests` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–°—Ç–∞—Ä—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å (Compose v2):**
```yaml
depends_on:
  - postgres  # –ü—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫, –±–µ–∑ —É—Å–ª–æ–≤–∏–π
```
- ‚ùå –ù–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

**‚ö†Ô∏è –í–∞–∂–Ω—ã–π –Ω—é–∞–Ω—Å:**

`depends_on` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è **–∑–∞–ø—É—Å–∫–∞**:

```bash
docker-compose down
# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤ –õ–Æ–ë–û–ú –ø–æ—Ä—è–¥–∫–µ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
```

---

### üîÑ RESTART

```yaml
restart: unless-stopped
```

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

**–ü–æ–ª–∏—Ç–∏–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞:**

| –ü–æ–ª–∏—Ç–∏–∫–∞ | –ö–æ–≥–¥–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è |
|----------|----------------------|
| `no` | –ù–∏–∫–æ–≥–¥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) |
| `always` | –í—Å–µ–≥–¥–∞ –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ |
| `on-failure` | –¢–æ–ª—å–∫–æ –ø—Ä–∏ –æ—à–∏–±–∫–µ (–∫–æ–¥ ‚â† 0) |
| `unless-stopped` | –í—Å–µ–≥–¥–∞, –∫—Ä–æ–º–µ —Ä—É—á–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ |

**–ü–æ–¥—Ä–æ–±–Ω–æ –ø—Ä–æ `unless-stopped`:**

**–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ü–ï–†–ï–ó–ê–ü–£–°–¢–ò–¢–°–Ø:**
- ‚úÖ –£–ø–∞–ª —Å –æ—à–∏–±–∫–æ–π (crashed)
- ‚úÖ Docker daemon –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª—Å—è
- ‚úÖ –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª—Å—è

**–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ù–ï –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è:**
- ‚ùå –í—ã–ø–æ–ª–Ω–∏–ª–∏ `docker-compose stop backend`
- ‚ùå –í—ã–ø–æ–ª–Ω–∏–ª–∏ `docker stop users_api`

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**

**Crash –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
```bash
# Backend —É–ø–∞–ª —Å Out of Memory
# Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç
# ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–Ω–æ–≤–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
```

**–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:**
```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª–∏ —Å–µ—Ä–≤–µ—Ä
# Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞—Ä—Ç—É–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
# ‚úÖ –°–µ—Ä–≤–∏—Å—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å
```

**–†—É—á–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
docker-compose stop backend
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª–∏ —Å–µ—Ä–≤–µ—Ä
# ‚ùå Backend –ù–ï –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è (–±—ã–ª –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤—Ä—É—á–Ω—É—é)
```

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ:**

**`always` (–∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è):**
```yaml
restart: always
```
- –í—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –î–∞–∂–µ –ø–æ—Å–ª–µ `docker stop` (–ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ Docker)
- –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

**`on-failure` (—Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏):**
```yaml
restart: on-failure
restart: on-failure:3  # –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏
```
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ crashes
- –ù–ï –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–æ–¥–µ 0

**`unless-stopped` (–∑–æ–ª–æ—Ç–∞—è —Å–µ—Ä–µ–¥–∏–Ω–∞ - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
```yaml
restart: unless-stopped
```
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ crashes –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞—Ö
- –£–≤–∞–∂–∞–µ—Ç —Ä—É—á–Ω—É—é –æ—Å—Ç–∞–Ω–æ–≤–∫—É
- ‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:**

```yaml
# Backend - –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ–≥–¥–∞
backend:
  restart: unless-stopped  ‚úÖ

# PostgreSQL - –∫—Ä–∏—Ç–∏—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å
postgres:
  restart: always  ‚úÖ

# Tests - –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫
tests:
  # –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ–º restart  ‚úÖ
```

---

## –°–µ—Ä–≤–∏—Å 3: Tests (pytest)

```yaml
tests:
  build:
    context: .
    dockerfile: docker/tests.Dockerfile
  container_name: api_tests
  environment:
    API_BASE_URL: http://backend:8000
  depends_on:
    backend:
      condition: service_started
  networks:
    - app_network
  # command: pytest -v test_users_crud.py
  # volumes:
  #   - ./tests:/tests
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:**

### –û—Ç–ª–∏—á–∏—è –æ—Ç –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

1. **–ù–ï–¢ `restart`** - —Ç–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –∏ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è
2. **–ù–ï–¢ `ports`** - –Ω–µ –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø —Å–Ω–∞—Ä—É–∂–∏
3. **`service_started`** (–Ω–µ `healthy`) - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–∞–ø—É—Å–∫–∞ backend

---

### üåê ENVIRONMENT –¥–ª—è —Ç–µ—Å—Ç–æ–≤

```yaml
environment:
  API_BASE_URL: http://backend:8000
#                      ^^^^^^^^
#                      DNS –∏–º—è —Å–µ—Ä–≤–∏—Å–∞!
```

**–ü–æ—á–µ–º—É `backend:8000`, –∞ –Ω–µ `localhost:8000`?**

```
‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
API_BASE_URL: http://localhost:8000
# localhost –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ = —Å–∞–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä tests
# Backend –ù–ï –¥–æ—Å—Ç—É–ø–µ–Ω

‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
API_BASE_URL: http://backend:8000
# backend = DNS –∏–º—è –≤ app_network
# Backend –¥–æ—Å—Ç—É–ø–µ–Ω
```

---

### üí¨ –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ü–∏–∏

#### Custom command
```yaml
# command: pytest -v test_users_crud.py
```

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
```yaml
# –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
command: pytest -v test_users_crud.py -m smoke
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ —á–µ—Ä–µ–∑ CLI:**
```bash
# –ù–µ –º–µ–Ω—è—è docker-compose.yml
docker-compose run tests pytest -v test_users_crud.py
docker-compose run tests pytest -v -m smoke
docker-compose run tests bash  # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –æ–±–æ–ª–æ—á–∫–∞
```

#### Volume –¥–ª—è live-reload
```yaml
# volumes:
#   - ./tests:/tests
```

**–ó–∞—á–µ–º:**
- –ë–µ–∑ volume: –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç **–ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞**
- –° volume: –∏–∑–º–µ–Ω–µ–Ω–∏—è **—Å—Ä–∞–∑—É –≤–∏–¥–Ω—ã**

**–†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
```yaml
volumes:
  - ./tests:/tests
```

–¢–µ–ø–µ—Ä—å:
```bash
# 1. –ò–∑–º–µ–Ω–∏–ª–∏ test_users_crud.py
# 2. –ó–∞–ø—É—Å—Ç–∏–ª–∏
docker-compose run tests pytest -v
# ‚úÖ –ù–æ–≤—ã–π –∫–æ–¥ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –ë–ï–ó –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏!
```

---

## –£—Ä–æ–≤–µ–Ω—å 5: VOLUMES –∏ NETWORKS

### üì¶ VOLUMES (–≥–ª–æ–±–∞–ª—å–Ω–∞—è —Å–µ–∫—Ü–∏—è)

```yaml
volumes:
  postgres_data:
```

**–û–±—ä—è–≤–ª–µ–Ω–∏–µ named volume:**

- –î–µ–∫–ª–∞—Ä–∏—Ä—É–µ—Ç volume –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ
- –ë–µ–∑ —ç—Ç–æ–≥–æ Docker –Ω–µ —Å–æ–∑–¥–∞—Å—Ç volume
- –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è (—Ç–µ–∫—É—â–∞—è):**
```yaml
volumes:
  postgres_data:  # –ü—Ä–æ—Å—Ç–æ –∏–º—è
```

**–° –¥—Ä–∞–π–≤–µ—Ä–æ–º:**
```yaml
volumes:
  postgres_data:
    driver: local
    driver_opts:
      type: nfs
      o: addr=192.168.1.1,rw
      device: ":/path/to/dir"
```

**External volume:**
```yaml
volumes:
  postgres_data:
    external: true  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
```

**–ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

```bash
# –°–ø–∏—Å–æ–∫ volumes
docker volume ls

# –ò–Ω—Å–ø–µ–∫—Ü–∏—è
docker volume inspect dockerkube_postgres_data

# –£–¥–∞–ª–µ–Ω–∏–µ
docker volume rm dockerkube_postgres_data

# –û—á–∏—Å—Ç–∫–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö
docker volume prune
```

---

### üåê NETWORKS (–≥–ª–æ–±–∞–ª—å–Ω–∞—è —Å–µ–∫—Ü–∏—è)

```yaml
networks:
  app_network:
    driver: bridge
```

**–û–±—ä—è–≤–ª–µ–Ω–∏–µ —Å–µ—Ç–∏:**

**–î—Ä–∞–π–≤–µ—Ä—ã:**
- `bridge` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–µ—Ç—å (—Ç–µ–∫—É—â–∏–π)
- `host` - –±–µ–∑ –∏–∑–æ–ª—è—Ü–∏–∏
- `overlay` - –¥–ª—è Swarm (multi-host)
- `macvlan` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç MAC-–∞–¥—Ä–µ—Å
- `none` - –±–µ–∑ —Å–µ—Ç–∏

**–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**

**–° –ø–æ–¥—Å–µ—Ç—å—é:**
```yaml
networks:
  app_network:
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet: 172.28.0.0/16
          gateway: 172.28.0.1
```

**External network:**
```yaml
networks:
  app_network:
    external: true
```

**–ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

```bash
# –°–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–π
docker network ls

# –ò–Ω—Å–ø–µ–∫—Ü–∏—è
docker network inspect dockerkube_app_network

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker network connect app_network my_container

# –û—Ç–∫–ª—é—á–∏—Ç—å
docker network disconnect app_network my_container
```

---

## –£—Ä–æ–≤–µ–Ω—å 6: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### üîó –ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–ü–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∞ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π:**

```
docker-compose.yml
‚îÇ
‚îú‚îÄ‚îÄ networks (—Å–æ–∑–¥–∞—é—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏)
‚îÇ   ‚îî‚îÄ‚îÄ app_network ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        ‚îÇ
‚îú‚îÄ‚îÄ volumes (–≤—Ç–æ—Ä—ã–º–∏)    ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ postgres_data ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îê
‚îÇ                        ‚îÇ  ‚îÇ
‚îî‚îÄ‚îÄ services (—Ç—Ä–µ—Ç—å–∏–º–∏)  ‚îÇ  ‚îÇ
    ‚îÇ                    ‚îÇ  ‚îÇ
    ‚îú‚îÄ‚îÄ postgres ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
    ‚îÇ   ‚îî‚îÄ‚îÄ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç volume
    ‚îÇ
    ‚îú‚îÄ‚îÄ backend ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ   ‚îî‚îÄ‚îÄ depends_on: postgres (healthy)
    ‚îÇ
    ‚îî‚îÄ‚îÄ tests
        ‚îî‚îÄ‚îÄ depends_on: backend (started)
```

**–ü–æ—Ä—è–¥–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∏ `docker-compose up`:**

1. **Networks** ‚Üí `app_network`
2. **Volumes** ‚Üí `postgres_data`
3. **Services:**
   - –ó–∞–ø—É—Å–∫ `postgres`
   - –û–∂–∏–¥–∞–Ω–∏–µ healthcheck (–¥–æ 50 —Å–µ–∫)
   - –ó–∞–ø—É—Å–∫ `backend`
   - –ó–∞–ø—É—Å–∫ `tests`

---

### üéØ Best Practices

#### 1. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤

```yaml
# ‚ùå –ü–ª–æ—Ö–æ
image: postgres:latest

# ‚úÖ –•–æ—Ä–æ—à–æ
image: postgres:15-alpine

# ‚úÖ‚úÖ –û—Ç–ª–∏—á–Ω–æ
image: postgres:15.4-alpine
```

#### 2. –°–µ–∫—Ä–µ—Ç—ã

```yaml
# ‚ùå –ü–ª–æ—Ö–æ
environment:
  DB_PASSWORD: super_secret_123

# ‚úÖ –•–æ—Ä–æ—à–æ
env_file:
  - .env.local  # –í .gitignore!

# ‚úÖ‚úÖ –û—Ç–ª–∏—á–Ω–æ
secrets:
  - db_password
```

#### 3. Health checks

```yaml
# ‚úÖ –í—Å–µ–≥–¥–∞ –¥–ª—è –ë–î
healthcheck:
  test: ["CMD-SHELL", "pg_isready"]
  interval: 10s
  timeout: 5s
  retries: 5
```

#### 4. Resource limits

```yaml
# ‚úÖ –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ —Ä–µ—Å—É—Ä—Å—ã
deploy:
  resources:
    limits:
      cpus: '0.5'
      memory: 512M
    reservations:
      memory: 256M
```

#### 5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```yaml
# ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–æ—Ç–∞—Ü–∏—é –ª–æ–≥–æ–≤
logging:
  driver: "json-file"
  options:
    max-size: "10m"
    max-file: "3"
```

---

### üìù –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Docker Compose

#### –ó–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up

# –í —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
docker-compose up -d

# –° –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π
docker-compose up --build

# –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å (+ –µ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
docker-compose up postgres

# Scaling
docker-compose up --scale backend=3
```

#### –û—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã)
docker-compose stop

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å + —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# + —É–¥–∞–ª–∏—Ç—å volumes
docker-compose down -v

# + —É–¥–∞–ª–∏—Ç—å –æ–±—Ä–∞–∑—ã
docker-compose down --rmi all
```

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –õ–æ–≥–∏
docker-compose logs backend
docker-compose logs -f          # Follow
docker-compose logs --tail=100  # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫

# –ó–∞–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose exec backend bash
docker-compose exec postgres psql -U testuser -d testdb

# –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É
docker-compose run tests pytest -v
docker-compose run --rm tests bash  # --rm —É–¥–∞–ª–∏—Ç –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞
```

#### –°–±–æ—Ä–∫–∞

```bash
# –°–æ–±—Ä–∞—Ç—å –≤—Å–µ –æ–±—Ä–∞–∑—ã
docker-compose build

# –ë–µ–∑ –∫—ç—à–∞
docker-compose build --no-cache

# –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å
docker-compose build backend

# –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞
docker-compose build --parallel
```

#### –û—á–∏—Å—Ç–∫–∞

```bash
# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose rm

# –£–¥–∞–ª–∏—Ç—å orphan –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down --remove-orphans

# –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã
docker system prune -a
```

---

## üéì –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í—ã –∏–∑—É—á–∏–ª–∏:

‚úÖ **–°–∏–Ω—Ç–∞–∫—Å–∏—Å YAML** - –±–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä—É Docker Compose** - services, volumes, networks
‚úÖ **–î–µ—Ç–∞–ª–∏ –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞** - image, build, ports, volumes, healthcheck
‚úÖ **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤** - depends_on —Å —É—Å–ª–æ–≤–∏—è–º–∏
‚úÖ **–ü–æ–ª–∏—Ç–∏–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞** - restart strategies
‚úÖ **Best practices** - –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–µ–∫—Ä–µ—Ç—ã, –ª–∏–º–∏—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤

### üìö –î–∞–ª—å–Ω–µ–π—à–µ–µ –∏–∑—É—á–µ–Ω–∏–µ

1. **Dockerfile** - –∫–∞–∫ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –æ–±—Ä–∞–∑—ã
2. **Multi-stage builds** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞
3. **Docker networks** - –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
4. **Docker Swarm/Kubernetes** - –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –≤ production
5. **CI/CD** - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏ –∏ –¥–µ–ø–ª–æ—è

---

**–ê–≤—Ç–æ—Ä:** Claude Code
**–î–∞—Ç–∞:** 2025-12-21
**–í–µ—Ä—Å–∏—è:** 1.0
